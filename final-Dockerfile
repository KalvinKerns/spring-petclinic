ARG PETCLINIC_S2I_IMAGE
FROM "${PETCLINIC_S2I_IMAGE}" as intermediate
COPY ${JAR_FILE} application.jar
RUN java -Djarmode=layertools -jar /deployments/*.jar extract

FROM registry.redhat.io/openj9/openj9-11-rhel8:1.2
COPY --from=intermediate snapshot-dependencies .
COPY --from=intermediate dependencies .
COPY --from=intermediate spring-boot-loader .
COPY --from=intermediate application .
ENTRYPOINT ["java", "org.springframework.boot.loader.JarLauncher"]
